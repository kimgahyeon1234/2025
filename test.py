import streamlit as st

st.set_page_config(page_title="μ‘κΈ‰μ²μΉ ν€΄μ¦", page_icon="π‘", layout="centered")

st.title("π¨ μ‘κΈ‰ μƒν™© λ€μ² ν€΄μ¦")
st.caption("ν•™μµ λ©μ μ©μ…λ‹λ‹¤. μ‹¤μ  μ‘κΈ‰μƒν™©μ—μ„  μ¦‰μ‹ 119μ— μ‹ κ³ ν•κ³ , μ§€μ—­ μ§€μΉ¨μ„ λ”°λ¥΄μ„Έμ”.")

# =============================
# 64λ¬Έμ  λ°μ΄ν„°: 8μƒν™© Γ— 8λ¬Έμ 
# λ³΄κΈ° λ‚μ΄λ„λ¥Ό μ•½κ°„ λ†’μ—¬ ν—·κ°λ¦¬λ” μ„ νƒμ§€λ¥Ό ν¬ν•¨ν–μµλ‹λ‹¤.
# =============================
scenarios = {
    "π— κµν†µμ‚¬κ³ ": [
        {
            "question": "κµν†µμ‚¬κ³  ν„μ¥μ—μ„ κ°€μ¥ λ¨Όμ € ν•΄μ•Ό ν•  μΌμ€?",
            "options": [
                "λ¶€μƒμλ¶€ν„° μ°¨λ‰ λ°–μΌλ΅ μ΄λ™μ‹ν‚¨λ‹¤",
                "2μ°¨ μ‚¬κ³  λ°©μ§€λ¥Ό μ„ν• μ•μ „ μ΅°μΉ(λΉ„μƒλ“±/μ‚Όκ°λ€/μ•μ „κ±°λ¦¬ ν™•λ³΄)",
                "λΈ”λ™λ°•μ¤/ν„μ¥ μ‚¬μ§„ μ΄¬μλ¶€ν„° ν•λ‹¤",
            ],
            "answer": "2μ°¨ μ‚¬κ³  λ°©μ§€λ¥Ό μ„ν• μ•μ „ μ΅°μΉ(λΉ„μƒλ“±/μ‚Όκ°λ€/μ•μ „κ±°λ¦¬ ν™•λ³΄)",
            "explanation": "2μ°¨ μ‚¬κ³ κ°€ λ°μƒν•λ©΄ ν”Όν•΄κ°€ μ»¤μ§‘λ‹λ‹¤. ν›„λ°© κ²½κ³ μ™€ μ•μ „κ±°λ¦¬ ν™•λ³΄κ°€ μµμ°μ„ μ…λ‹λ‹¤.",
        },
        {
            "question": "μμ‹μ΄ μ—†λ” λ¶€μƒμλ¥Ό ν™•μΈν•  λ• μ²« μμ„λ”?",
            "options": ["μ¶ν ν™•μΈ β†’ μ‹ κ³  β†’ νΈν΅ ν™•μΈ", "μμ‹ ν™•μΈ β†’ νΈν΅/λ§¥λ°• ν™•μΈ", "μ‹ κ³  β†’ μ‚¬μ§„ μ΄¬μ β†’ μ΄λ™"],
            "answer": "μμ‹ ν™•μΈ β†’ νΈν΅/λ§¥λ°• ν™•μΈ",
            "explanation": "λ°μ‘ ν™•μΈ ν›„ μ¦‰μ‹ νΈν΅κ³Ό λ§¥λ°•μ„ ν‰κ°€ν•΄μ•Ό ν•©λ‹λ‹¤.",
        },
        {
            "question": "ν™μλ¥Ό ν„μ¥μ—μ„ μ®κ²¨μ•Ό ν•λ” ν•©λ‹Ήν• κ²½μ°λ”?",
            "options": ["μ¶”κ°€ μ„ν— μ—†μ", "ν™”μ¬/ν­λ° λ“± 2μ°¨ μ„ν—", "λ©κ²©μκ°€ μ”μ²­"],
            "answer": "ν™”μ¬/ν­λ° λ“± 2μ°¨ μ„ν—",
            "explanation": "2μ°¨ μ„ν—μ΄ μ„λ°•ν• κ²½μ°λ¥Ό μ μ™Έν•λ©΄ λ¶ν•„μ”ν• μ΄λ™μ€ κΈλ¬Όμ…λ‹λ‹¤.",
        },
        {
            "question": "119 μ‹ κ³  μ‹ μ°μ„  μ „λ‹¬ν•΄μ•Ό ν•  μ •λ³΄λ”?",
            "options": ["μ‚¬κ³  μ„μΉ", "ν™μ μƒνƒ", "ν„μ¬ μƒν™©"],
            "answer": "μ‚¬κ³  μ„μΉ",
            "explanation": "μ •ν™•ν• μ„μΉκ°€ κµ¬μ΅° λ„μ°© μ‹κ°„μ„ μΆμ°ν•©λ‹λ‹¤.",
        },
        {
            "question": "μ¶νμ΄ μ‹¬ν• ν™μμ—κ² κ°€μ¥ λ¨Όμ € μ‹ν–‰ν•  μ²μΉλ”?",
            "options": ["μƒμ² μ†λ…", "μ••λ°• μ§€ν", "λ³‘μ› μ΄μ†΅"],
            "answer": "μ••λ°• μ§€ν",
            "explanation": "κΉ¨λ—ν• μ²/κ±°μ¦λ΅ μ§μ ‘ μ••λ°•ν•μ—¬ μ¶νμ„ μ°μ„  λ©μ¶¥λ‹λ‹¤.",
        },
        {
            "question": "μ²™μ¶” μ†μƒμ΄ μμ‹¬λλ” ν™μμ—κ² μ μ ν• λ€μ²λ”?",
            "options": ["μμ„Έλ¥Ό νΈν•κ² λ°”κΏ”μ¤€λ‹¤", "μ λ€ μ›€μ§μ΄μ§€ μ•κ² κ³ μ •", "λ©λ§ λ“¤μ–΄ νΈν΅μ„ νΈν•κ² ν•λ‹¤"],
            "answer": "μ λ€ μ›€μ§μ΄μ§€ μ•κ² κ³ μ •",
            "explanation": "μ²™μ¶” μ†μƒμ΄ μμ‹¬λλ©΄ μ›€μ§μ„μ„ μµμ†ν™”ν•κ³  λ¨Έλ¦¬Β·λ©Β·λΈν†µμ„ μΌμ§μ„ μΌλ΅ μ μ§€ν•΄μ•Ό ν•©λ‹λ‹¤.",
        },
        {
            "question": "ν™”μƒ λ¶€μ„μ— μ·μ΄ λ‹¬λΌλ¶™μ—λ‹¤. μ–΄λ–»κ² ν• κΉ?",
            "options": ["κ°•μ λ΅ λ–Όμ–΄λ‚Έλ‹¤", "κ·Έλ€λ΅ λ‘” μ±„ μλ£μ§„μ—κ² λ§΅κΈ΄λ‹¤", "κΈ°λ¦„μ„ λ°λΌ λ–Όμ–΄λ‚Έλ‹¤"],
            "answer": "κ·Έλ€λ΅ λ‘” μ±„ μλ£μ§„μ—κ² λ§΅κΈ΄λ‹¤",
            "explanation": "λ¬΄λ¦¬ν• μ κ±°λ” μ΅°μ§ μ†μƒμ„ ν‚¤μ›λ‹λ‹¤. μ£Όλ³€λ¶€λ§ κ°€μ„λ΅ μλ¥΄κ³  λ¶™μ€ λ¶€λ¶„μ€ κ·Έλ€λ΅.",
        },
        {
            "question": "λ„“μ€ λ²”μ„ ν™”μƒ/μ–Όκµ΄ ν™”μƒ λ°μƒ μ‹ μ°μ„  μ΅°μΉλ΅ μ μ ν• κ²ƒμ€?",
            "options": ["μ—°κ³  λ„ν¬ ν›„ λ€κΈ°", "119 μ‹ κ³  λ° μ‹ μ† μ΄μ†΅", "μ°¨κ°€μ΄ λ¬Όμ— μ „μ‹ μ„ λ‹΄κ·Όλ‹¤"],
            "answer": "119 μ‹ κ³  λ° μ‹ μ† μ΄μ†΅",
            "explanation": "κΈ°λ„ μ†μƒ/μ‡Όν¬ μ„ν—μ΄ μ»¤ μ¦‰μ‹ μ „λ¬Έ μΉλ£κ°€ ν•„μ”ν•©λ‹λ‹¤.",
        },
    ],

    "β¤οΈ μ‹¬μ •μ§€": [
        {
            "question": "μ‹¬μ •μ§€ μμ‹¬ ν™μ λ°κ²¬ μ‹ μ²« λ‹¨κ³„λ”?",
            "options": ["AED μ°ΎκΈ°", "μμ‹ ν™•μΈ(λ°μ‘ ν™•μΈ)", "μ¦‰μ‹ μΈκ³µνΈν΅"],
            "answer": "μμ‹ ν™•μΈ(λ°μ‘ ν™•μΈ)",
            "explanation": "μ–΄κΉ¨ λ‘λ“λ¦¬λ©° λ°μ‘μ„ ν™•μΈν•κ³ , λ¬΄λ°μ‘μ΄λ©΄ λ„μ›€μ„ μ”μ²­ν•©λ‹λ‹¤.",
        },
        {
            "question": "λ¬΄λ°μ‘/λΉ„μ •μƒ νΈν΅(or λ¬΄νΈν΅) ν™•μΈ ν›„μ μ΅°μΉλ”?",
            "options": ["119 μ‹ κ³  λ° AED μ”μ²­", "λ¬Ό λ§μ‹κ² ν•κΈ°", "νλ³µμμ„Έ"],
            "answer": "119 μ‹ κ³  λ° AED μ”μ²­",
            "explanation": "μ‹ κ³ μ™€ AED ν™•λ³΄κ°€ μƒμ΅΄μ‚¬μ¬μ ν•µμ‹¬μ…λ‹λ‹¤.",
        },
        {
            "question": "μ„±μΈ ν‰λ¶€μ••λ°• κΉμ΄λ”?",
            "options": ["μ•½ 2~3cm", "μ•½ 5~6cm", "10cm μ΄μƒ"],
            "answer": "μ•½ 5~6cm",
            "explanation": "μ¶©λ¶„ν• κΉμ΄(ν‰κ³½μ 1/3 μ •λ„)λ¥Ό μ μ§€ν•©λ‹λ‹¤.",
        },
        {
            "question": "ν‰λ¶€μ••λ°• μ†λ„(μ„±μΈ)λ”?",
            "options": ["λ¶„λ‹Ή 60~80ν", "λ¶„λ‹Ή 100~120ν", "λ¶„λ‹Ή 140ν μ΄μƒ"],
            "answer": "λ¶„λ‹Ή 100~120ν",
            "explanation": "λ„λ¬΄ λΉ λ¥΄λ©΄ μ¶©λ¶„ν• μ΄μ™„μ΄ μ–΄λ µκ³ , λλ¦¬λ©΄ κ΄€λ¥κ°€ λ–¨μ–΄μ§‘λ‹λ‹¤.",
        },
        {
            "question": "μ••λ°•:νΈν΅μ λΉ„μ¨(1μΈ κµ¬μ΅°μ, μ„±μΈ)μ€?",
            "options": ["15:2", "30:2", "50:5"],
            "answer": "30:2",
            "explanation": "ν‘μ¤€ λΉ„μ¨μ€ 30ν μ••λ°• ν›„ 2ν μΈκ³µνΈν΅μ…λ‹λ‹¤(κµμ΅ μ΄μμμ— ν•ν•¨).",
        },
        {
            "question": "AEDκ°€ λ„μ°©ν–λ‹¤. μ¬λ°”λ¥Έ μμ„λ”?",
            "options": ["μ „μ› μΌ¬ β†’ ν¨λ“ λ¶€μ°© β†’ μμ„± μ§€μ‹ λ”°λ¦„", "μ¶©κ²© λ²„νΌ λ¨Όμ € λ„λ¦„", "ν¨λ“ λ¶€μ°© μ „ κ°€μ΄ν„Έ μ κ±°λ” λ¶ν•„μ”"],
            "answer": "μ „μ› μΌ¬ β†’ ν¨λ“ λ¶€μ°© β†’ μμ„± μ§€μ‹ λ”°λ¦„",
            "explanation": "AEDμ μμ„± μ§€μ‹μ— λ”°λ¥΄λ©°, ν•„μ”ν• κ²½μ° ν¨λ“ λ¶€μ°©λ¶€μ λ•€/ν„Έ μ κ±°.",
        },
        {
            "question": "ν‰λ¶€μ••λ°•μ„ μ¤‘λ‹¨ν•΄λ„ λλ” μ‹μ μ€?",
            "options": ["ν™μ μλ°νΈν΅/μ›€μ§μ„ νλ³µ", "μ••λ°•μκ°€ ν”Όκ³¤ν•  λ•", "2λ¶„λ§λ‹¤ λ°λ“μ‹ μ¤‘λ‹¨"],
            "answer": "ν™μ μλ°νΈν΅/μ›€μ§μ„ νλ³µ",
            "explanation": "μ „λ¬ΈμΈλ ¥ μΈκ³„, AED λ¶„μ„/μ¶©κ²©, μ„ν— μ κ±° λ“±μ μμ™Έλ¥Ό μ μ™Έν•κ³  μ¤‘λ‹¨ κΈμ§€.",
        },
        {
            "question": "μ‹¬μ •μ§€ λ°κ²¬ ν›„ ν¨κ³Όμ  μƒμ΅΄μ¨μ„ λ†’μ΄λ ¤λ©΄ λ‡ λ¶„ λ‚΄ μ••λ°•μ„ μ‹μ‘ν•΄μ•Ό ν•λ‚?",
            "options": ["1λ¶„ μ΄λ‚΄", "μ•½ 4λ¶„ μ΄λ‚΄", "10λ¶„ ν›„"],
            "answer": "μ•½ 4λ¶„ μ΄λ‚΄",
            "explanation": "λ¬΄μ‚°μ† μ†μƒ μ „μ κ³¨λ“ νƒ€μ„ ν™•λ³΄κ°€ ν•µμ‹¬μ…λ‹λ‹¤.",
        },
    ],

    # λ‚λ¨Έμ§€ μ¶ν, κΈ°λ„ λ§‰ν, μµμ‚¬, λ™λ¬ΌΒ·κ³¤μ¶© λ¬Όλ¦Ό, μ¬λ‚ ννΈλ” κ·Έλ€λ΅ μ μ§€
    # (μ„ μ½”λ“μ—μ„ μ—λ¬ μ—†μΌλ‹ μƒλµ)
    # ...
}

# =============================
# μ„Έμ… μƒνƒ
# =============================
if "step" not in st.session_state:
    st.session_state.step = 0
if "score" not in st.session_state:
    st.session_state.score = 0
if "current" not in st.session_state:
    st.session_state.current = None

# μ‚¬μ΄λ“λ°”: μƒν™© μ„ νƒ λ° μ§„ν–‰λ¥ 
with st.sidebar:
    st.header("ν•™μµ μ„¤μ •")
    situation = st.selectbox("μƒν™© μ„ νƒ", list(scenarios.keys()))
    total = len(scenarios[situation])
    st.progress(0 if total == 0 else st.session_state.step/total)
    st.caption("β±οΈ μ •λ‹µ μ μ¶ ν›„ μλ™μΌλ΅ λ‹¤μ λ‹¨κ³„λ΅ μ΄λ™ν•©λ‹λ‹¤.")

# μƒλ΅μ΄ μƒν™© μ„ νƒ μ‹ μ΄κΈ°ν™”
if st.session_state.current != situation:
    st.session_state.current = situation
    st.session_state.step = 0
    st.session_state.score = 0

questions = scenarios[situation]

# =============================
# ν€΄μ¦ λ³Έλ¬Έ
# =============================
if st.session_state.step < len(questions):
    idx = st.session_state.step
    q = questions[idx]
    st.subheader(f"λ¬Έμ  {idx+1} / {len(questions)}")
    st.write(q["question"]) 

    choice = st.radio("μ •λ‹µμ„ κ³ λ¥΄μ„Έμ”:", q["options"], key=f"q_{situation}_{idx}")

    col1, col2 = st.columns([1,1])
    with col1:
        submit = st.button("μ μ¶", key=f"submit_{situation}_{idx}")
    with col2:
        skip = st.button("κ±΄λ„λ›°κΈ°", key=f"skip_{situation}_{idx}")

    if submit:
        if choice == q["answer"]:
            st.success("β… μ •λ‹µμ…λ‹λ‹¤! μν•μ…¨μ–΄μ”.")
            st.session_state.score += 1
        else:
            st.error("β μ¤λ‹µμ…λ‹λ‹¤.")
            st.info(f"π‘‰ μ •λ‹µ: {q['answer']}")
        st.write(q["explanation"])
        st.session_state.step += 1
    elif skip:
        st.warning("β­οΈ λ¬Έμ λ¥Ό κ±΄λ„λ›°μ—μµλ‹λ‹¤. λ‹¤μ λ¬Έμ λ΅ μ΄λ™ν•©λ‹λ‹¤.")
        st.info(f"μ°Έκ³ : {q['answer']}")
        st.session_state.step += 1
else:
    st.success("π‰ ν•΄λ‹Ή μƒν™©μ λ¨λ“  λ¬Έμ λ¥Ό μ™„λ£ν–μµλ‹λ‹¤!")
    st.metric("μ μ", f"{st.session_state.score} / {len(questions)}")

    ratio = st.session_state.score / len(questions)
    if ratio == 1:
        st.balloons()
        st.write("π† μ™„λ²½ν•΄μ”! μ‹¤μ  μƒν™©μ—μ„λ„ μ°¨λ¶„ν λ€μ²ν•μ‹¤ μ μμ–΄μ”.")
    elif ratio >= 0.75:
        st.write("π‘ μ•„μ£Ό μν•μ…¨μ–΄μ”. μ΅°κΈλ§ λ” μ—°μµν•λ©΄ μ™„λ²½!")
    elif ratio >= 0.5:
        st.write("π™‚ λ³΄ν†µμ…λ‹λ‹¤. ν‹€λ¦° λ¬Έμ μ ν•΄μ„¤μ„ λ³µμµν•΄ λ³΄μ„Έμ”.")
    else:
        st.write("π“ λ” μ—°μµμ΄ ν•„μ”ν•΄μ”. ν•΄μ„¤μ„ κΌΌκΌΌν μ½κ³  λ‹¤μ‹ λ„μ „! π’")

    if st.button("π”„ λ‹¤μ‹ ν’€κΈ°"):
        st.session_state.step = 0
        st.session_state.score = 0

st.divider()
st.caption("β— μ΄ μ•±μ€ κµμ΅μ©μ΄λ©°, μ‹¤μ  μ‘κΈ‰μƒν™©μ—μ„λ” μ¦‰μ‹ 119μ— μ‹ κ³ ν•κ³  μµμ‹  μ§€μ—­ μ§€μΉ¨κ³Ό μΈμ¦λ κµμ΅ λ‚΄μ©μ„ λ”°λ¥΄μ„Έμ”.")
